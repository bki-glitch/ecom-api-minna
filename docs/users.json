{
  "paths": {
    "/api/register": {
      "post": {
        "tags": ["users"],
        "summary": "Register a new user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "first_name": {"type": "string", "description": "User's first name"},
                  "last_name": {"type": "string", "description": "User's last name"},
                  "email": {"type": "string", "format": "email", "description": "User's email address"},
                  "password": {"type": "string", "description": "User's password"},
                  "user_type_id": {"type": "integer", "description": "ID of the user type from user_types table", "nullable": true},
                  "contact_number": {"type": "string", "description": "User's contact/phone number", "nullable": true, "example": "+1234567890"},
                  "address": {"type": "string", "description": "User's address", "nullable": true},
                  "status": {"type": "string", "enum": ["active", "inactive"], "default": "active"},
                  "otp": {"type": "string", "nullable": true},
                  "is_password_reset": {"type": "boolean", "default": false},
                  "remarks": {"type": "string", "nullable": true}
                },
                "required": ["first_name", "last_name", "email", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {"description": "User registered successfully"},
          "400": {"description": "Missing required fields or validation error"},
          "409": {"description": "Email already exists"}
        }
      }
    },
    "/api/login": {
      "post": {
        "tags": ["users"],
        "summary": "Login user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {"type": "string", "format": "email"},
                  "password": {"type": "string"}
                },
                "required": ["email", "password"]
              }
            }
          }
        },
        "responses": {"200": {"description": "Login successful, returns JWT"}}
      }
    },
    "/api/users": {
      "get": {
        "tags": ["users"],
        "summary": "List all users",
        "responses": {"200": {"description": "List of users"}}
      }
    },
    "/api/users/{id}": {
      "get": {
        "tags": ["users"],
        "summary": "Get user by ID",
        "parameters": [
          {"name": "id", "in": "path", "required": true, "schema": {"type": "integer"}}
        ],
        "responses": {"200": {"description": "User details"}}
      },
      "put": {
        "tags": ["users"],
        "summary": "Update user by ID",
        "parameters": [
          {"name": "id", "in": "path", "required": true, "schema": {"type": "integer"}}
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "first_name": {"type": "string"},
                  "last_name": {"type": "string"},
                  "email": {"type": "string", "format": "email"},
                  "password": {"type": "string"},
                  "status": {"type": "string", "enum": ["active", "inactive"]},
                  "otp": {"type": "string", "nullable": true},
                  "is_password_reset": {"type": "boolean"},
                  "remarks": {"type": "string", "nullable": true}
                }
              }
            }
          }
        },
        "responses": {"200": {"description": "User updated"}}
      },
      "delete": {
        "tags": ["users"],
        "summary": "Delete user by ID",
        "parameters": [
          {"name": "id", "in": "path", "required": true, "schema": {"type": "integer"}}
        ],
        "responses": {"200": {"description": "User deleted"}}
      }
    },
    "/api/verify-otp": {
      "post": {
        "tags": ["users"],
        "summary": "Verify OTP for a user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {"type": "string", "format": "email"},
                  "otp": {"type": "string"}
                },
                "required": ["email", "otp"]
              }
            }
          }
        },
        "responses": {"200": {"description": "OTP verified or error"}}
      }
    },
    "/api/resend-otp": {
      "post": {
        "tags": ["users"],
        "summary": "Resend OTP for a user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {"type": "string", "format": "email"}
                },
                "required": ["email"]
              }
            }
          }
        },
        "responses": {"200": {"description": "OTP resent or error"}}
      }
    },
    "/api/reset-password": {
      "post": {
        "tags": ["users"],
        "summary": "Reset password using OTP",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {"type": "string", "format": "email"},
                  "otp": {"type": "string"},
                  "new_password": {"type": "string"}
                },
                "required": ["email", "otp", "new_password"]
              }
            }
          }
        },
        "responses": {"200": {"description": "Password reset or error"}}
      }
    }
  },
  "components": {
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "id": {"type": "integer", "description": "User ID"},
          "first_name": {"type": "string", "description": "User's first name"},
          "last_name": {"type": "string", "description": "User's last name"},
          "email": {"type": "string", "format": "email", "description": "User's email address"},
          "user_type_id": {"type": "integer", "description": "ID of the user type", "nullable": true},
          "user_type": {"type": "string", "description": "User type name (from join)", "nullable": true},
          "user_type_description": {"type": "string", "description": "User type description (from join)", "nullable": true},
          "contact_number": {"type": "string", "description": "User's contact/phone number", "nullable": true},
          "address": {"type": "string", "description": "User's address", "nullable": true},
          "status": {"type": "string", "enum": ["active", "inactive"], "description": "User status"},
          "otp": {"type": "string", "description": "One-time password", "nullable": true},
          "is_password_reset": {"type": "boolean", "description": "Password reset flag"},
          "remarks": {"type": "string", "description": "Additional remarks", "nullable": true},
          "created_at": {"type": "string", "format": "date-time", "description": "Creation timestamp"},
          "updated_at": {"type": "string", "format": "date-time", "description": "Last update timestamp"}
        }
      }
    }
  }
}
